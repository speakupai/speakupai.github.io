<h1 id="speakupai-project-update">SpeakUpAI Project Update</h1>
<h1 id="background-and-significance-of-project">Background and Significance of Project</h1>
<p>Audio is invisible. On its face, this might seem like the most obvious statement in the world - humans literally can&#39;t see sound (unless they have synesthesia...). But what I mean is this: humans are visual-dominant creatures and because we can&#39;t see audio, itâ€™s easy to miss its importance - and its impact. This impact is felt in so many areas of media, but let&#39;s scope it just to spoken audio. <a href="https://news.usc.edu/141042/why-we-believe-something-audio-sound-quality/">Research has shown that people are more likely to trust information that comes to them as higher quality spoken audio.</a> </p>
<p>Whether they&#39;re aware of it or not, people are more likely to consume content that <em>sounds better</em>, but the problem is - it&#39;s difficult and time-consuming to make spoken audio sound professional. </p>
<p>Instagram, Snapchat, Tiktok, and YouTube have revolutionized photo and video content creation - giving consumers access to filters, effects, and editing techniques that used to be the realm of professionals. The same revolution has not yet come for spoken audio. </p>
<p>There are plenty of DAW plugins and other products that can produce amazing results, but given the fact that maybe only 5-10% of my audience understood that &#39;DAW&#39; stands for &#39;Digital Audio Workstation&#39;, it&#39;s clear that these products are out of the realm of your typical consumer. The vast majority of content that has professional-sounding audio is either recorded by professionals or by amateurs who have spent large amounts of time and money learning to record and engineer audio.</p>
<p>This is where SpeakUpAI comes in. We want every aspiring podcaster, YouTuber, MOOCs teacher, and every other creator of spoken audio content to be able to produce professional-sounding audio. With SpeakUpAI&#39;s state of the art machine learning technology, users can simply record spoken audio on their phone or tablet, upload it to our site, and our ML model will return an &#39;enhanced&#39; version - denoised, dereverberated, normalized, EQ&#39;d, etc, etc. - for them to download and use in whatever application they choose.</p>
<p>SpeakUpAI wants everyone to sound professional. We&#39;re <em>hear</em> to democratize audio.</p>
<hr>
<h1 id="explanation-of-data-sets">Explanation of Data sets</h1>
<p>We&#39;ve intentionally sourced the same three datasets that were used in the creation of <a href="https://daps.cs.princeton.edu/projects/HiFi-GAN/index.php?env-pairs=DAPS&amp;speaker=f10&amp;src-env=all">HiFi-GAN</a>, the academic paper upon which we&#39;ve based our research. </p>
<h2 id="speech---daps">Speech - DAPS</h2>
<p>As the creators of the <a href="https://archive.org/details/daps_dataset">DAPS dataset</a> describe it:</p>
<blockquote>
<p>A dataset of professional production quality speech and corresponding aligned speech recorded on common consumer devices.
[...]
This dataset is a collection of aligned versions of professionally produced studio speech recordings and recordings of the same speech on common consumer devices (tablet and smartphone) in real world environments. It consists of 20 speakers (10 female and 10 male) reading 5 excerpts each from public domain books[...]</p>
</blockquote>
<p>(They even have <a href="https://ccrma.stanford.edu/~gautham/Site/Publications_files/mysore-spl2015.pdf">a paper</a> they wrote about it!)</p>
<p>This is a dataset that is more or less tailor-made for our application - supervised learning for speech denoising. We have high-quality studio recordings of many different speakers (10 male and 10 female) for training.  The unaltered audio (in .wav format) of these recordings acts as our output/target (or y), and we perform pre-processing and convolution on that same audio with our <strong>Noise</strong> and <strong>Impulse Response</strong> datasets to create our input (or X).</p>
<p>Additionally, we have the same twenty speakers reading the same material on different consumer devices in different real-world environments for testing. This really is perfect for our application, since it allows us to test generalization on never-before-seen examples while still maintaining conceptual continuity for subjective testing. These test examples also very closely mirror our intended use-case for our model - processing audio recorded across different devices in many different environments.</p>
<p>If our model generalizes well to this test set, but performs significantly worse on other real-world examples, it will give us a much clearer idea of whether we&#39;re overfitting on the 18 specific speakers in our training set. In turn, this will allow us to better tweak our data collection and pre-processing to make the model more robust.</p>
<h2 id="noise---ace-challenge-dataset">Noise - ACE Challenge dataset</h2>
<p>Our &quot;Noise&quot; dataset is a collection of audio recordings focusing on what would typically be called background or ambient noise - the hisses, hums, and other persistent sounds present in almost all non-professional audio recordings. Because our audio targets are (intentionally) devoid of such noise, we use this dataset to add it back in and create our input data.</p>
<p>In this case, we&#39;ve sourced the <a href="https://ieee-dataport.org/documents/ace-challenge-2015#files">ACE Challenge dataset</a>.</p>
<h2 id="impulse-response-room-soundreverb---reverb-challenge-dataset">Impulse Response (Room sound/reverb) - REVERB Challenge dataset</h2>
<p>Another important aspect of audio recordings - and one that&#39;s particularly noticeable in professional recordings in particular - is the impulse response or &#39;room sound&#39; of the space in which the recording is made. This is often referred to in the audio industry as &#39;reverb&#39; (short for reverberation), and most professional voice-over, podcast, and other spoken media go through great lengths to minimize the audience&#39;s perception of the room in which the media was recorded (this can be referred to as making a recording &#39;dry&#39;).</p>
<p>Because our output audio from the DAPS set is already very dry, we create our inputs by convolving the output with a variety of impulse responses taken from the <a href="https://www.openslr.org/28/">REVERB Challenge dataset</a>.</p>
<hr>
<h1 id="explanation-of-processes-methods">Explanation of Processes (Methods)</h1>
<h2 id="hifi-gan">HiFi-GAN</h2>
<p>As the authors <a href="https://daps.cs.princeton.edu/projects/HiFi-GAN/index.php?env-pairs=DAPS&amp;speaker=f10&amp;src-env=all">explain</a>: </p>
<blockquote>
<p>Real-world audio recordings are often degraded by factors such as noise, reverberation, and equalization distortion. This paper introduces HiFi-GAN, a deep learning method to transform recorded speech to sound as though it had been recorded in a studio. We use an end-to-end feed-forward WaveNet architecture, trained with multi-scale adversarial discriminators in both the time domain and the time-frequency domain. It relies on the deep feature matching losses of the discriminators to improve the perceptual quality of enhanced speech. The proposed model generalizes well to new speakers, new speech content, and new environments. It significantly outperforms state-of-the-art baseline methods in both objective and subjective experiments.</p>
</blockquote>
<p>Here, generator G includes a feed-forward WaveNet for speech enhancement, followed by a convolutional Postnet for cleanup. Discriminators evaluate the resulting waveform ($D_{W}$, at multiple resolutions) and mel-spectrogram ($D_{S}$).</p>
<p>On a practical level, we&#39;re using a PyTorch implementation of the HiFi-GAN model, <a href="https://github.com/w-transposed-x/hifi-gan-denoising">forked</a> from the awesome folks at <code>w-transposed-x</code>. As with any deep learning projects, our initial efforts went towards getting the model up and running (aka lots of troubleshooting), test runs, and hyperparameter tweaks based on performance. </p>
<p>We did initial testing on Google Colab, which is great for testing since it&#39;s an inexpensive platform. The disadvantage, however, is that users are limited to VMs with a single GPU. </p>
<p>So, once we got hyperparameters and performance to a functional level, we moved to Amazon EC2 (+ S3 for storage). EC2 instances have the advantage of being scalable - since our PyTorch implementation was built for distributed training on up to 4 GPUs, we spun up a 4GPU instance and started testing.</p>
<p>Currently, we&#39;re dealing with performance scaling issues between our single GPU training on Colab and the four GPU EC2.</p>
<h2 id="pipeline">Pipeline</h2>
<p>Currently, work on HiFi-GAN is limited to audio recorded at 16khz sample rate. True high-fidelity audio is recorded at sample rates of 44.1khz or above. To this end, we&#39;ve also implemented an <a href="https://openreview.net/pdf?id=S1gNakBFx">Audio Super Resolution</a> U-Net model, with the intention of training it on 44.1k audio downsampled to 16k.</p>
<p>Once we have this model trained, we can use it after HiFi-GAN in a pipeline to take raw speech audio, enhance/denoise it, and then upsample it to the desired high-fidelity sample rate.</p>
<p>Currently, we have our super resolution U-Net properly implemented in TensorFlow 2.x (it was originally implemented in 1.x, and the porting process was time-consuming), though further training work will wait as we optimize HiFi-GAN.</p>
<hr>
<h1 id="explanation-of-outcomes-current-results">Explanation of Outcomes (current results)</h1>
<p>We take a small clip of audio from our DAPS dataset, recorded on a common consumer device (iPad) in a common location (office), and we run it through our HiFi-GAN archicture.</p>
<p>The following results are from HiFi-GAN  after a very, very brief training (~1.5% of total steps from the original paper).</p>
<h3 id="before-hifi-gan">Before HiFi-GAN</h3>
<h3 id="after">After</h3>
<p><a href="project-update-media/Week_12_raw_snippet.wav">project-update-media/Week_12_raw_snippet.wav</a></p>
<h2 id="subjective-results">Subjective Results</h2>
<p><a href="project-update-media/Week_12_denoised_snippet.wav">project-update-media/Week_12_denoised_snippet.wav</a></p>
<p>As you can hear, almost 100% of the background noise (often described as &#39;hum&#39; or - in this case - &#39;hiss&#39;) has been removed. There is still some obvious artifacting in the spoken voice, but remember - this is a preliminary with a VERY tiny fraction of the full training.</p>
<h2 id="objective-results">Objective Results</h2>
<p><img src="project-update-media/Untitled.png" alt="project-update-media/Untitled.png"></p>
<p>As you can see, the model is improving consistently with each increase in training. We&#39;ll be continuing to ramp up the training steps/epochs as we continue development - e.g. iron out some of the kinks with augmentation and distributed training - until our loss curves flatten, at which point we&#39;ll consider the results &#39;final&#39; for this particular model iteration.</p>
<hr>
<h1 id="system-design-and-ethical-considerations">System Design and Ethical Considerations</h1>
<h2 id="overall-system-design">Overall System Design</h2>
<p><img src="project-update-media/Untitled%201.png" alt="project-update-media/Untitled%201.png"></p>
<h2 id="hifi-gan-system-design">HiFi-GAN System Design</h2>
<p><img src="project-update-media/Untitled%202.png" alt="project-update-media/Untitled%202.png"></p>
<hr>
<h1 id="future-work-and-timeplan">Future work and Timeplan</h1>
<h2 id="timeplan">Timeplan</h2>
<p><img src="project-update-media/Untitled%203.png" alt="project-update-media/Untitled%203.png"></p>
<h2 id="future-work">Future Work</h2>
<ul>
<li>Implementation of Bryan/HiFi-GAN Impulse Response augmentation</li>
<li>Longer training of Generator (wavenet and wavenet-postnet) models</li>
<li>Using Audio Super-Resolution model to upscale results from 16k to 44.1k (and beyond!)</li>
<li>Taking different audio/video formats as input - currently only <code>.wav</code></li>
<li>Optimizing inference performance (currently works at near-realtime on a single GPU)</li>
<li>Implement Spark</li>
</ul>
<h1 id="related-work-papers-github">Related Work (Papers, github)</h1>
<p>This is by no means comprehensive, but the following are some of the papers, repos, and products we researched while creating SpeakUpAI. Items marked with &quot;***&quot; are directly utilized in our research.</p>
<h2 id="automatic-mixing">Automatic Mixing</h2>
<ul>
<li><a href="https://www.eecs.qmul.ac.uk/~josh/documents/2017/WIMP2017_Martinez-RamirezReiss.pdf">Deep learning and intelligent audio mixing</a></li>
<li><a href="https://intelligentsoundengineering.wordpress.com/category/machine-learning/">Intelligent Sound Engineering</a></li>
</ul>
<h2 id="vocal-denoising-specific">Vocal DeNoising specific</h2>
<h3 id="papers">Papers</h3>
<ul>
<li><a href="https://openreview.net/pdf?id=S1gNakBFx">Audio Super-Resolution using Neural Nets</a> ***</li>
<li><a href="https://sthalles.github.io/practical-deep-learning-audio-denoising/">Practical Deep Learning Audio Denoising</a></li>
<li><a href="https://paperswithcode.com/paper/audio-super-resolution-using-neural-networks">Audio Super-Resolution using neural networks</a></li>
<li><a href="https://paperswithcode.com/paper/audio-denoising-with-deep-network-priors">Speech Denoising by Accumulating Per-Frequency Modeling Fluctuations</a></li>
<li><a href="https://blog.insightdatascience.com/using-deep-learning-to-reconstruct-high-resolution-audio-29deee8b7ccd">using Deep learning to reconstruct high-resolution audio</a><ul>
<li><a href="https://github.com/jhetherly/EnglishSpeechUpsampler/tree/master/preprocessing">Preprocessing tools</a></li>
</ul>
</li>
<li><a href="https://github.com/vbelz/Speech-enhancement">Speech-enhancement (denoising)</a></li>
<li><a href="https://timsainburg.com/noise-reduction-python.html">Conventional DSP Noise Reduction</a></li>
</ul>
<h3 id="products">Products</h3>
<ul>
<li><a href="https://accusonus.com/products/audio-repair">Accusonus</a></li>
<li><a href="https://www.izotope.com/en/learn/how-to-mix-vocals-with-nectar-3-vocal-assistant.html">Izotope Vocal Assistant</a></li>
</ul>
<h2 id="audio-and-de-noising-gans">Audio and De-Noising GANs</h2>
<ul>
<li><a href="https://github.com/chrisdonahue/wavegan">WAVEGAN</a> ***</li>
<li><a href="https://daps.cs.princeton.edu/projects/HiFi-GAN/index.php?env-pairs=DAPS&amp;speaker=f10&amp;src-env=all">HiFi-GAN</a> ***</li>
<li><a href="https://magenta.tensorflow.org/gansynth">Magenta GANSynth</a></li>
<li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1746809419302137">DN-Gan for Denoising</a> and <a href="https://github.com/manumathewthomas/ImageDenoisingGAN">code</a></li>
</ul>
<h2 id="impulse-response-augmentation">Impulse Response Augmentation</h2>
<ul>
<li><a href="https://arxiv.org/pdf/1909.03642.pdf">IMPULSE RESPONSE DATA AUGMENTATION AND DEEP NEURAL NETWORKS
FOR BLIND ROOM ACOUSTIC PARAMETER ESTIMATION</a> ***</li>
</ul>
